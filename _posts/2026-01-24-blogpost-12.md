---
title: "Insecure Deserialization: A Practical Example"
excerpt: Walkthrough of an interesting exercise on TryHackMe, using PHPGGC to perform an injection attack on a web-server.
date: 2026-01-24
---

While working through the [insecure deserialisation](https://tryhackme.com/room/insecuredeserialisation) room on TryHackMe, I came across an exercise that peaked my interest: Task 7 discusses PHPGGC (PHP Gadget Chains), a tool for automating this aspect of pentesting, specifically for PHP applications.

Broadly speaking, insecure deserialisation exploits occur when an application trusts serialised data enough to use it without validating its authenticity. This trust can lead to disastrous outcomes as attackers manipulate serialised objects to achieve remote code execution, escalate privileges, or launch DoS attacks. This type of vulnerability is prevalent in applications that serialise and deserialise complex data structures across various programming environments, such as Java and PHP, which often use serialisation for remote procedure calls or session management.

This blog post is a walkthrough of the exercises in Task 7.


## What is PHPGGC?

PHPGGC provides a library of gadget chains for various PHP frameworks and libraries. These gadget chains are sequences of objects and methods designed to exploit specific vulnerabilities when a PHP application unsafely unserialises user-provided data.

The main purpose of PHPGGC is to facilitate the generation of serialised payloads that can trigger these vulnerabilities. It helps security researchers and penetration testers create payloads that demonstrate the impact of insecure deserialisation flaws.

Users can customise payloads by specifying arguments for the functions or methods involved in the gadget chain, thereby tailoring the attack to achieve specific outcomes, such as encoding.


## Exercise 1

> What is the vector for exploiting CodeIgniter4/FR1 as per the PHPGGC?

The module teaches us some syntax and how to look up vulnerabbilities for specific frameworks. To this end, we navigate to `/opt/phpggc`, where the binary is stored, and run the following command:

```console
root@ip-10-82-120-124:/opt/phpggc# php phpggc -l codeigniter

Gadget Chains
-------------

NAME                 VERSION                       TYPE            VECTOR        I    
CodeIgniter4/FD1     <= 4.3.6                      File delete     __destruct         
CodeIgniter4/FD2     <= 4.3.7                      File delete     __destruct         
CodeIgniter4/FR1     4.0.0 <= 4.3.6                File read       __toString    *    
CodeIgniter4/RCE1    4.0.2                         RCE: Command    __destruct         
CodeIgniter4/RCE2    4.0.0-rc.4 <= 4.3.6           RCE: Command    __destruct         
CodeIgniter4/RCE3    4.0.4 <= 4.4.3                RCE: Command    __destruct         
CodeIgniter4/RCE4    4.0.0-beta.1 <= 4.0.0-rc.4    RCE: Command    __destruct         
CodeIgniter4/RCE5    -4.1.3+                       RCE: Command    __destruct         
CodeIgniter4/RCE6    -4.1.3 <= 4.2.10+             RCE: Command    __destruct  
```

We find that there exists a file read vulnerability in CodeIgniter4/FR1 leveraging the magic method `__toString`.


## Exercise 2

