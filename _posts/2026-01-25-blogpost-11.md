---
title: "Hacking the Juice Shop"
excerpt: A collection of walkthroughs of different hacking challenges surrounding the OWASP Juice Shop 
date: 2026-01-25
---

This blogpost is a selection of walkthroughs of some of the hacking-challenges found in the OWASP Juice Shop that I considered particularly interesting.

(This is work in progress. The write-ups are ordered by categories that are found in `/#/score-board` on the web application.)


### Table of Contents
1. [Sensitive Data Exposure](#sensitive-data-exposure)
   1. [Accessing Sensitive Documents](#accessing-sensitive-documents)
2. [Broken Access Control](#broken-access-control)
   1. [Pulling User-Data as a Low-Privilege User](#pulling-user-data-as-a-low-privilege-user)
3. [Injection](#injection)
   1. [Login Admin](#login-admin)
   2. [Database Schema & User Credentials](#database-schema--user-credentials)
4. [Miscellaneous](#miscellaneous)
   1. [Security Policy](#security-policy)
5. [Unvalidated Redirects](#unvalidated-redirects)
   1. [Outdated Allowlist](#outdated-allowlist)

<br>


## Sensitive Data Exposure

### Accessing Sensitive Documents

One of the first things I did while doing reconnaissance on the Juice Shop was to run `dirbuster`, in hopes of finding subdirectories that are easily missed but might still contain useful information. I simply ran

```console
dirb http://localhost:3000/ -o dirb_output
```

The output showed several results, namely 

```shell
---- Scanning URL: http://127.0.0.1:3000/ ----
+ http://127.0.0.1:3000/assets (CODE:301|SIZE:156)
+ http://127.0.0.1:3000/ftp (CODE:200|SIZE:11298)
+ http://127.0.0.1:3000/profile (CODE:500|SIZE:1051)
+ http://127.0.0.1:3000/promotion (CODE:200|SIZE:6586)
+ http://127.0.0.1:3000/redirect (CODE:500|SIZE:3339)
+ http://127.0.0.1:3000/robots.txt (CODE:200|SIZE:28)
+ http://127.0.0.1:3000/video (CODE:200|SIZE:10075518)
+ http://127.0.0.1:3000/Video (CODE:200|SIZE:10075518)
```

The most interesting information is contained in `/ftp`, as can be seen in this screenshot:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/d6c9f93d-adba-4476-a62f-8e92da40a1dd"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

Right away we can access the files `acquisitions.md`, `legal.md` and `announcement_encrypted.md`, but it seems like no other file formats are allowed to be viewed. We can bypass this issue by making use of the poison null-byte trick, i.e. instead of trying to view `/ftp/eastere.gg`, we enter `/ftp/eastere.gg%2500.md` and then we can successfully view the content. The same goes with `coupons_2013.md.bak`, `package.json.bak` and `suspicious_errors.yml`. 

<br>




## Broken Access Control

###  Pulling User-Data as a Low-Privilege User

At the end of this challenge we will have pulled an exhaustive list of usernames and e-mail addresses. While this may not be quite as devastating as a specific SQL-injection payload with which one can additionally obtain all hashed passwords, we're still able to read data which should be out of reach.

To begin with, I logged in as user Jim with `jim@juice-sh.op:ncc-1701`. I obtained these credentials through the earlier challenges "Login Jim" and "Reset Jim's Password" using SQL injections, weak password reset functionality and OSINT. To confirm that Jim only has customer privileges and no admin rights, we navigate to `http://localhost:3000/#/administration` and find that we cannot access the page:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/84d4fce8-968f-4db5-8e79-2ae4b42940c5"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

While investigating XSS vulnerabiities in another challenge, I noticed that there exists an API endpoint called `/api/`, which popped up in Burp Suite as a GET request of the form `GET /api/Quantitys/ HTTP/1.1` when entering a payload into the search bar of the Juice Shop. 

The endpoint `/api/Quantitys/` itself contained nothing too serious, but the lucky idea I had was to investigate the endpoint `/api/users/`, since I thought there might be a good chance that this exists. So as this this low-privilege user, I proceeded as follows: First, it seems like the endpoint existed, since I only got a 401 error saying that no authorization header was found, but not a 500 error code for instance.

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/3c2766bd-1584-472b-b0ab-948aa3882fae"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

I remembered from the endpoint `/api/Quantitys/` that the request header contained an authorization token, as can be seen here in Burp:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/dfece9b4-035d-4b7b-b6e7-0d96d798f825"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

So the idea was to simply copy the token and paste it into the request header for the endpoint `/api/users`. After sending the request to the repeater in Burp and adding the token, we indeed get a 200 response and we can view a list of all users with e-mails and additional information:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/0a1a3c35-7fe6-48ad-abde-35626eafb57f"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

For completeness, here are the last few entries of this list:

```
{
  "id": 20,
  "username": "SmilinStan",
  "email": "stan@juice-sh.op",
  "role": "deluxe",
  "deluxeToken": "8f70e0f4b05685efff1ab979e8f5d7e39850369309bb206c2ad3f7d51a1f4e39",
  "lastLoginIp": "",
  "profileImage": "assets/public/images/uploads/20.jpg",
  "isActive": true,
  "createdAt": "2025-12-14T14:06:03.182Z",
  "updatedAt": "2025-12-14T14:06:03.182Z",
  "deletedAt": null
},
{
  "id": 21,
  "username": "evmrox",
  "email": "ethereum@juice-sh.op",
  "role": "deluxe",
  "deluxeToken": "b49b30b294d8c76f5a34fc243b9b9cccb057b3f675b07a5782276a547957f8ff",
  "lastLoginIp": "",
  "profileImage": "assets/public/images/uploads/default.svg",
  "isActive": true,
  "createdAt": "2025-12-14T14:06:03.183Z",
  "updatedAt": "2025-12-14T14:06:03.183Z",
  "deletedAt": null
},
{
  "id": 22,
  "username": "",
  "email": "testing@juice-sh.op",
  "role": "admin",
  "deluxeToken": "",
  "lastLoginIp": "",
  "profileImage": "assets/public/images/uploads/defaultAdmin.png",
  "isActive": true,
  "createdAt": "2025-12-14T14:06:03.183Z",
  "updatedAt": "2025-12-14T14:06:03.183Z",
  "deletedAt": null
}
```

As mentioned above, this information disclosure may not be catastrophic right away. However, it does give us a large attack surface with which we can potentially do more damage in future challenges.

For instance, we can now try to brute-force passwords more easily, since we already have e-mails which are used for logins. Moreover, we see all users with admin privileges, so we might want to focus on these accounts in particular. Lastly, we could now try extensive phishing-campaigns and we can try to exploit the `deluxeToken` that comes with some of the users.

As a last note, I believe this technically does not solve any official Juice Shop challenge. At least I never triggered any success-banner that you usually see when solving a task.

<br>




## Injection

### Login Admin

The Juice Shop contains many different SQL injection vulnerabilities, the easiest of which being a vulnerability in the login page.

In order to test for SQL injection vulnerabilities, I entered the classic testing-payload `'` into the user e-mail field together with any random password. This will yield an intersting error message in Burp Suite:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/8f846b4b-4893-41bc-beeb-dad080001c90"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

We see that there seems to be a vulnerability here, since we can directly talk to the database in the backend and trigger an SQL error. Next, I sent the above request to the intruder and used the standard SQLi wordlist `~/SecLists/Fuzzing/Databases/SQLi/Generic-SQLi.txt` to fuzz the user input. Already, the attack looked promising, since it returns different http-error-codes after only the first 13 payloads out of 268 in total:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/d36236b8-6a78-48a3-9ec3-33eddc3cb2d7"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

We saw earlier in the error with only `'` that the syntax is as follows:

```sql
SELECT * FROM Users WHERE email = '${userInputEmail}' AND password = '${hashedPassword}' AND deletedAt IS NULL;
 ```

 So if we used a payload like `' or '1'='1'--` (line 231 in the intruder output, code 500), then really in the backend we get
 
```sql
SELECT * FROM Users
WHERE email = '' OR '1'='1' --'
AND password = 'e0227fa7fa03f2a1644a86c973da4d91'
AND deletedAt IS NULL
```

and more importantly, everything after `--` is simply ignored, and hence we force an **authentication bypass**, since it is entirely irrelevant what password we pass into the login field. Better yet, if we bypass the authentication process in this way, we are automatically logged in as `admin@juice-sh.op`! This is simply because the user `admin` is the very first user in the list of all users, and this user is picked by virtue of the above payload. 

<br>


### Database Schema & User Credentials

For this exercise, I wanted to try the "Database Schema" challenge, since leaking an entire database together with hashed passwords felt like the holy grail to me. 

My first attempt was to try and tinker more with the login form, since this allowed for an SQL injection in the previous exercise. However, this did not go very far, since we can study the error message after entering "`'`" to find that we are already inside the `Users` table upon sending the login form request.

The hint on the Juice Shop score board said the following:

> Find out where this information could come from. Then craft a UNION SELECT attack string against an endpoint that offers an unnecessary way to filter data.

I remembered there being a parameter for pulling information from the database when searching for items using the page's search bar. More precisely, this was the endpoint `/rest/products/search?q=`. This potentially looks like an unnecessary way to filter data for several reasons:

1. No pagination: It likely returns ALL matching products at once
2. No filtering/sorting options: Limited to just keyword search
3. No caching: Hits database on every request
4. No rate limiting: Could be abused for DoS attacks

Upon setting `q='` as the parameter, I did not trigger an error and just received an empty list. In order to fuzz this parameter for any vulnerabilities, I decided to run `sqlmap`:

```console
sqlmap -u http://localhost:3000/rest/products/search?q= --dbs --level=2 --risk=2
```

Note that `--dbs` tries to enumerate database names and `--level`/`--risk` determine how thoroughly the tests are performed. Part of the output was the following:

```
---
Parameter: q (GET)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: q=') AND 4318=4318 AND ('MUaO' LIKE 'MUaO
---
```

This tells us that the parameter is indeed vulnerable. While this exact payload did not work for me, I could slightly modify it and then URL-encode all key characters in Burp, and this would give me an SQL error message:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/073ea41b-24a1-45e1-b39f-b24cf31bd78c"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

Now the goal was to somehow include a `UNION SELECT` command within this injection payload. Before we do so, we can use `sqlmap` once more to try and automate the enumeration of the database schema. I used the following command:

```console
sqlmap -u http://localhost:3000/rest/products/search?q= --schema
```

This returned 20 tables and for each one it returned its respective schema, albeit in an ugly format. This is the schema for the "Users" table, for instance:

```sql
[INFO] retrieved: CREATE TABLE `Users`
(
`id` INTEGER PRIMARY KEY AUTOINCREMENT,
`username` VARCHAR(255) DEFAULT '',
`email` VARCHAR(255) UNIQUE,
`password` VARCHAR(255),
`role` VARCHAR(255) DEFAULT 'customer',
`deluxeToken` VARCHAR(255) DEFAULT '',
`lastLoginIp` VARCHAR(255) DEFAULT '0.0.0.0',
`profileImage` VARCHAR(255) DEFAULT '/assets/public/images/uploads/default.svg',
`totpSecret` VARCHAR(255) DEFAULT '',
`isActive` TINYINT(1) DEFAULT 1,
`createdAt` DATETIME NOT NULL,
`updatedAt` DATETIME NOT NULL,
`deletedAt` DATETIME
)
```

Technically this finishes the challenge, but of course this would be somewhat boring (and this did not trigger the challenge success banner!). After getting stuck for a while, I noticed that I had read the error in the previous screenshpt incorrectly: the payload should rather begin with something like `asdf'))` instead of just `')`, since there are two parentheses that need closing, and adding `asdf` just ensured that no empty string is parsed and throws pathological errors:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/77f7c3ea-d2bd-4b40-aaba-e412f6f351fb"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

Some online research told me that I should try a payload like `UNION SELECT sql FROM sqlite_master`, since this is a table containing all schemas that comes with the SQLite database by default. Now I had to find out the number of tables (remember `sqlmap` told us there are 20, but this can be highly inaccurate!). Checking by hand as seen below, I found 9 tables:

```sql
asdf')) UNION SELECT sql FROM sqlite_master --             --> 500 error
asdf')) UNION SELECT sql,'2' FROM sqlite_master --         --> 500 error 
asdf')) UNION SELECT sql,'2','3' FROM sqlite_master --     --> 500 error
...
...
(Test until "200 OK" response)
```

One important caveat was that I had to URL-encode key characters again, because otherwise I would always get a 400 error code:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/1c26678b-35d3-4a36-84c3-5c9ce399db15"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/cbc86699-963e-422e-b211-b65be7d35899"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

The second screenshot's response contains the entire database schema, and I believe at this point the success banner was triggered!

Finally, we can modify the payload to obtain the database schema one more time, in order to exfiltrate a list of (hashed) user credentials. Remember from earlier that we know exactly what the "Users" schema looks like. Thus, we can tell the backend to return, say, `id`, `email`, `password`, `role` and `deluxeToken`, all useful information from our perspective. The payload then looks as follows:

```sql
asdf')) UNION SELECT id,email,password,role,deluxeToken,'6','7','8','9' FROM Users--
```

After URL-encoding the payload, we indeed get a full list of user credentials, which we can now try to crack and use for further challenges:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/581ebc57-614e-4d54-8bb6-fd7ac8652c4e"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>



## Miscellaneous

### Security Policy




## Unvalidated Redirects

### Outdated Allowlist






